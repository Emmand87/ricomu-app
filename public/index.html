<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>RICOMU • Ricorso Multe Online | Scansione verbale e ricorso automatico</title>
  <meta name="description" content="RICOMU: carichi o scatti una foto al verbale e ottieni un ricorso completo (min. 2000 parole) con motivi principali e fonti ufficiali. Paghi solo se ti serve il PDF finale.">
  <meta name="keywords" content="ricorso multe, ricorso verbale, codice della strada, autovelox, notifica tardiva, PEC, Prefetto, Giudice di Pace">
  <meta property="og:title" content="RICOMU • Ricorso Multe Online">
  <meta property="og:description" content="Scatta la foto al verbale, noi generiamo il ricorso completo con AI e fonti ufficiali.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/og-cover.png">
  <meta name="theme-color" content="#111827">

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="/styles.css">
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"RICOMU - Ricorso Multe in Italia",
    "applicationCategory":"LegalService",
    "operatingSystem":"Web",
    "description":"Carica o scatta una foto al verbale e ottieni un ricorso completo e personalizzato con AI.",
    "url":"https://ricomu-app.onrender.com",
    "publisher":{"@type":"Organization","name":"RICOMU"}
  }
  </script>
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="brand">
        <div class="logo">R</div>
        <h1>RICOMU — Ricorso Multe in Italia</h1>
      </div>
      <p class="tagline">
        Scansiona la multa e fai ricorso in 3 minuti.
        <span class="muted">
          Fonti ufficiali sempre aggiornate tramite AI.
          <strong>Oltre il 90% di ricorsi vinti!</strong> Prova RICOMU.
        </span>
      </p>

      <!-- HERO: 3 box azione nella prima schermata -->
      <div class="hero-grid">
        <!-- 1) Fotocamera -->
        <div class="hero-card">
          <h3>Scansiona il verbale con la fotocamera</h3>
          <p class="muted small">Inquadra, scatta, aggiungi più pagine e invia.</p>
          <button id="heroStartCam" class="btn btn-primary" type="button">Apri fotocamera</button>
        </div>

        <!-- 2) Upload -->
        <div class="hero-card">
          <h3>Carica PDF/Foto del verbale</h3>
          <p class="muted small">Se hai già il file, caricalo e procedi subito.</p>
          <div class="upload-inline">
            <input id="heroFile" type="file" accept="image/*,.jpg,.jpeg,.png,application/pdf" capture="environment" class="hidden" />
            <button id="heroUpload" class="btn" type="button">Scegli file</button>
          </div>
          <p id="heroStatus" class="muted small"></p>
        </div>

        <!-- 3) Inserimento manuale -->
        <div class="hero-card">
          <h3>Inserisci a mano i dati del verbale</h3>
          <p class="muted small">Per verbali illeggibili o scritti a mano.</p>
          <button id="openManual" class="btn btn-outline" type="button">Apri modulo</button>
        </div>
      </div>
    </div>
    <div class="hero-wave"></div>
  </header>

  <main class="container">
    <!-- WORKSPACE: appare quando si procede -->
    <section id="workspace" class="card hidden">
      <!-- CAMERA BLOCK (solo se scelgo “Apri fotocamera”) -->
      <div id="cameraBlock" class="camera hidden">
        <h2>Scansione con fotocamera</h2>
        <video id="camVideo" playsinline autoplay muted></video>
        <canvas id="camCanvas" class="hidden"></canvas>
        <div class="cam-overlay"></div>
        <div class="cam-controls">
          <button id="btnShot" class="btn btn-primary" type="button">Scatta</button>
          <button id="btnRetake" class="btn btn-ghost hidden" type="button">Riscatta</button>
          <button id="btnAddPage" class="btn btn-outline hidden" type="button">Aggiungi pagina</button>
          <button id="btnFinishScan" class="btn btn-success hidden" type="button">Invia scansioni</button>
          <button id="btnCloseCam" class="btn btn-ghost" type="button">Chiudi fotocamera</button>
        </div>
        <div id="scanThumbs" class="thumbs"></div>
        <p id="scanStatus" class="muted"></p>
      </div>

      <!-- FALLBACK: quando i dati non sono leggibili -->
      <section id="fallback" class="notice hidden" role="alert">
        <h3>Purtroppo la scansione non è adeguata per rilevare i dati automaticamente.</h3>
        <p class="muted">Procedi a una nuova scansione oppure inserisci i dati a mano.</p>
        <div class="notice-actions">
          <button id="fbRetryScan" class="btn btn-outline" type="button">Nuova scansione</button>
          <button id="fbManual" class="btn btn-primary" type="button">Inserisci i dati a mano</button>
        </div>
      </section>

      <!-- STEP 2: RIEPILOGO / MOTIVI -->
      <section id="step2" class="subcard hidden">
        <h2>Riepilogo e motivi del ricorso</h2>
        <div id="summary"></div>
      </section>

      <!-- STEP 3: CORREZIONI -->
      <section id="step3" class="subcard hidden">
        <h2>Correggi eventuali errori</h2>
        <div class="grid">
          <div><label>Numero verbale</label><input id="v_number" type="text"/></div>
          <div><label>Autorità</label><input id="v_authority" type="text"/></div>
          <div><label>Articolo CdS</label><input id="v_article" type="text"/></div>
          <div><label>Luogo</label><input id="v_place" type="text"/></div>
          <div><label>Data infrazione</label><input id="v_dateInfrazione" type="date"/></div>
          <div><label>Data notifica</label><input id="v_dateNotifica" type="date"/></div>
          <div><label>Importo (€)</label><input id="v_amount" type="number"/></div>
          <div><label>Targa</label><input id="v_targa" type="text"/></div>
        </div>
        <p class="muted">Dati anagrafici</p>
        <div class="grid">
          <div><label>Nome Cognome</label><input id="u_name" type="text"/></div>
          <div><label>Comune</label><input id="u_comune" type="text"/></div>
          <div><label>Data di nascita</label><input id="u_dob" type="date"/></div>
          <div><label>Indirizzo</label><input id="u_addr" type="text"/></div>
          <div><label>Codice Fiscale</label><input id="u_cf" type="text"/></div>
        </div>
        <div style="margin-top:10px;"><button class="btn" id="btnSaveCorrections" type="button">Salva correzioni & ricalcola</button></div>
      </section>

      <!-- STEP 5: ANTEPRIMA -->
      <section id="step5" class="subcard hidden">
        <h2>Anteprima a tempo (non cliccabile/selezionabile)</h2>
        <p class="muted">Watermark “BOZZA NON UTILIZZABILE”, visibile 30 secondi; poi si passa al pagamento.</p>
        <div><button class="btn" id="btnPreview" type="button">Genera anteprima</button></div>
        <div id="previewCanvasWrap" class="muted" style="margin-top:10px;"></div>
        <p id="previewTimer" class="muted"></p>
      </section>

      <!-- STEP 6: PAGAMENTO -->
      <section id="step6" class="subcard hidden">
        <h2>Pagamento</h2>
        <p id="price" class="muted" style="font-weight:bold;"></p>
        <div><button class="btn btn-primary" id="btnPay" type="button">Paga con Stripe (test)</button></div>
        <p class="muted">Carta test: 4242 4242 4242 4242</p>
      </section>

      <!-- STEP 7: FINALE -->
      <section id="step7" class="subcard hidden">
        <h2>Scarica PDF finale</h2>
        <a class="btn btn-success" id="btnFinal" href="#" download>Scarica il PDF</a>
      </section>

      <!-- STEP 8/9: ISTRUZIONI E VADEMECUM -->
      <section id="step8" class="subcard hidden">
        <h2>Invio PEC / Raccomandata</h2>
        <p><strong>PEC:</strong> invia all’indirizzo PEC dell’ente indicato nel verbale. Oggetto: “Ricorso avverso verbale n. [Numero]”.</p>
        <p><strong>Raccomandata A/R:</strong> stampa PDF, firma, allega documento, busta con dicitura “Ricorso avverso verbale n. [Numero]”.</p>
      </section>

      <section id="step9" class="subcard hidden">
        <h2>Vademecum</h2>
        <p id="vademecum"></p>
        <p class="muted">Parametri configurabili. Verifica normativa aggiornata.</p>
      </section>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>© RICOMU — Ricorso Multe in Italia</p>
      <p class="muted small" style="margin-top:8px">
        * Dato indicativo. L’esito dipende dal singolo caso e dall’ente destinatario.
      </p>
    </div>
  </footer>

  <!-- MODALE: Inserimento manuale -->
  <div id="manualModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Inserisci i dati del verbale</h3>
        <button id="closeManual" class="btn btn-ghost small" type="button">Chiudi</button>
      </div>
      <div class="grid">
        <div><label>Numero verbale</label><input id="m_number" type="text"/></div>
        <div><label>Autorità</label><input id="m_authority" type="text"/></div>
        <div><label>Articolo CdS</label><input id="m_article" type="text"/></div>
        <div><label>Luogo</label><input id="m_place" type="text"/></div>
        <div><label>Data infrazione</label><input id="m_dateInfrazione" type="date"/></div>
        <div><label>Data notifica</label><input id="m_dateNotifica" type="date"/></div>
        <div><label>Importo (€)</label><input id="m_amount" type="number" min="0"/></div>
        <div><label>Targa</label><input id="m_targa" type="text"/></div>
      </div>
      <p class="muted">Dati anagrafici</p>
      <div class="grid">
        <div><label>Nome Cognome</label><input id="m_name" type="text"/></div>
        <div><label>Comune</label><input id="m_comune" type="text"/></div>
        <div><label>Data di nascita</label><input id="m_dob" type="date"/></div>
        <div><label>Indirizzo</label><input id="m_addr" type="text"/></div>
        <div><label>Codice Fiscale</label><input id="m_cf" type="text"/></div>
      </div>
      <div class="modal-actions">
        <button id="submitManual" class="btn btn-primary" type="button">Procedi</button>
      </div>
    </div>
  </div>

  <!-- Overlay loader -->
  <div id="loaderOverlay" class="loader-overlay hidden" aria-hidden="true">
    <div class="loader-card">
      <div class="spinner-ring" aria-label="Elaborazione in corso"></div>
      <p class="loader-title">Elaborazione in corso…</p>
      <p class="loader-sub">Stiamo analizzando il verbale con AI e OCR.<br/>Attendi ~1 minuto.</p>
    </div>
  </div>

  <script src="/app.js" defer></script>
</body>
</html>
